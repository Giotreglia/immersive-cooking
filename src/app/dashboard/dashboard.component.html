<div class="container-fluid py-5">
    <div class="d-flex mb-3 justify-content-between">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb text-primary">
                <li class="breadcrumb-item text-primary" style="cursor: pointer;" aria-current="page" (click)="routeTo('dashboard/home')">Dashboard</li>
                <li class="breadcrumb-item breadcrumb-active" style="cursor: pointer;" aria-current="page">Ricette</li>
            </ol>
        </nav>
        <h4>{{user.username}}</h4>
    </div>
    <div class="row shadow p-4 rounded">
        <div class="col-12 d-flex flex-column justify-content-between h-100">
            <div class="d-flex w-100 justify-content-between align-items-center">
                <h1 class="fs-1">Ricette</h1>
                <button class="btn btn-lg btn-primary mb-2" [routerLink]="['/dashboard/nuova-ricetta']"><i class="fa-solid fa-plus me-3"></i>Crea ricetta</button>
            </div>
            <div class="row">
                <div class="col">
                    <div class="mb-3 d-flex flex-column">
                        <label for="name" class="mb-2">Cerca per titolo</label>
                        <input id="name" type="search" class="form-control w-100" placeholder="Cerca" aria-label="Username" aria-describedby="basic-addon1" [(ngModel)]="searchText" (input)="filterRecipes()">
                    </div>
                </div>
               <!--  <div class="col">
                    <div class="mb-3 d-flex flex-column">
                        <label for="author" class="mb-2">Filtra per categoria</label>
                        <select id="author" type="text" class="form-select w-100" placeholder="Cerca" aria-label="Username" aria-describedby="basic-addon1" [(ngModel)]="authorId" (onchange)="filterRecipes()"> 
                            <option value="0">Tutti</option>
                            <option [value]="curator.id" *ngFor="let curator of curators">{{curator.name}} - {{curator.organization.name}}</option>
                        </select>
                    </div>
                </div> -->
            </div>
            <div class="rounded pt-5 px-3 d-flex flex-column justify-content-between flex-grow-1" style="background-color: white;">
                <div style="height: 500px; overflow-y: auto;">
                    <table class="table table-striped table-hover">
                        <thead>
                            <tr class="fw-bold">
                                <th scope="col">Id</th>
                                <th scope="col">Thumb</th>
                                <th scope="col" class="title">Nome</th>
                                <th scope="col">Azioni</th>
                            </tr>
                        </thead>
                        <tbody class="overflow-auto">
                          <tr *ngFor="let recipe of filteredRecipes; index as i">
                            <td>{{ recipe.id }}</td>
                            <td>
                                <div class="d-flex justify-content-center w-100">
                                    <div class="position-relative overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded min-h-100px
                                    d-flex justify-content-center align-content-center overflow-hidden" style="width: 200px;" [style.background-image]="'url('+recipe.s3filename+')'">                            
                                    </div>
                                </div>
                            </td>
                            <td><p class="title m-0">{{ recipe.name }}</p></td>
                            <td>
                                <div class="d-flex justify-content-center gap-2">
                                    <button class="btn btn-sm btn-icon btn-secondary" [routerLink]="['/dashboard/ricetta', recipe.id]">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-icon btn-primary" [routerLink]="['/dashboard/modifica-ricetta', recipe.id]">
                                      <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn btn-sm btn-icon btn-danger" data-bs-toggle="modal" (click)="recipe.showModal = !recipe.showModal">
                                      <i class="fas fa-trash"></i>
                                    </button>
                                    <!-- Modal -->
                                    <div class="modal fade" [class]="recipe.showModal?'show':''" tabindex="-1" aria-labelledby="exampleModalLabel" [style.display]="recipe.showModal?'block':'none'">
                                        <div class="modal-dialog modal-dialog-centered">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h1 class="modal-title fs-5" id="exampleModalLabel">{{recipe.name}}</h1>
                                                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close" (click)="recipe.showModal = false"></button>
                                            </div>
                                            <div class="modal-body">
                                                Sei sicuro di voler eliminare questa ricetta?
                                            </div>
                                            <div class="modal-footer">
                                                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal" (click)="recipe.showModal = false">Annulla</button>
                                                <button type="button" class="btn btn-primary" (click)="deleteRecipe(recipe.id)">Elimina</button>
                                            </div>
                                        </div>
                                        </div>
                                    </div>
                                    <button class="btn btn-sm btn-icon btn-warning" [routerLink]="['/dashboard/recipe-documents', recipe.id]">
                                        <i class="fas fa-folder text-light"></i>
                                    </button>
                                </div>
                            </td>
                          </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
        <!-- <div class="d-flex w-100 justify-content-center mt-3">
            <nav aria-label="Page navigation example">
                <ul class="pagination">
                  <li class="page-item"><button class="page-link" (click)="goToPage(1)" [disabled]="currentPage === 1"><i class="fa-solid fa-angles-left"></i></button></li>
                  <li class="page-item"><button class="page-link" (click)="prevPage()" [disabled]="currentPage === 1"><i class="fa-solid fa-chevron-left"></i></button></li>
                  <li class="page-item" *ngFor="let page of pagesToShow"><button class="page-link" [class.active]="currentPage === page" (click)="goToPage(page)">{{ page }}</button></li>
                  <li class="page-item"><button class="page-link" (click)="nextPage()" [disabled]="currentPage === totalPages"><i class="fa-solid fa-chevron-right"></i></button></li>
                  <li class="page-item"><button class="page-link" (click)="goToPage(totalPages)" [disabled]="currentPage === totalPages"><i class="fa-solid fa-angles-right"></i></button></li>
                </ul>
            </nav>
        </div> -->
    </div>
</div>