<div class="container-fluid py-5">
    <div class="d-flex mb-3 justify-content-between">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb text-primary">
                <li class="breadcrumb-item text-primary" style="cursor: pointer;" aria-current="page" (click)="routeTo('dashboard/home')">Dashboard</li>
                <li class="breadcrumb-item breadcrumb-active" style="cursor: pointer;" aria-current="page">Ricetta</li>
            </ol>
        </nav>
        <h4 *ngIf="user">{{user.username}}</h4>
    </div>
    <div *ngIf="selectedRecipe" class="row shadow p-4 rounded" style="max-height: 75vh; overflow: auto;">
        <div class="col-12 d-flex flex-column justify-content-between h-100">
            <div class="d-flex flex-column w-100">
                <div class="d-flex w-100 justify-content-between align-items-center">
                    <h1 class="fs-1 mb-0 d-inline">{{selectedRecipe.name}}</h1>
                    <div class="fst-italic fs-5">
                        <span *ngIf="selectedRecipe.portion_unit == 'person'"><i class="fa-solid fa-user me-2"></i>x {{selectedRecipe.portion_number}} persone</span>
                        <span *ngIf="selectedRecipe.portion_unit == 'gram'"><i class="fa-solid fa-weight-hanging me-2"></i>x {{selectedRecipe.portion_number}} grammi</span>
                        <span *ngIf="selectedRecipe.portion_unit == 'bakingTray'"><i class="fa-solid fa-layer-group me-2"></i>x {{selectedRecipe.portion_number}} teglie</span>
                    </div>
                </div>
                <div class="fs-5">
                    <span class="me-1"><i class="fa-brands fa-envira" [style.color]="selectedRecipe.color"></i></span>
                    <span class="fw-bold" [style.color]="selectedRecipe.color">{{selectedRecipe.footprint_score | number : '1.0-1'}}</span>
                    <span class="fw-bold"> / 10</span>
                </div>
            </div>
            
            <div class="rounded pt-5 px-3 d-flex flex-column justify-content-between flex-grow-1" style="background-color: white;">
                <div class="row">
                    <div class="col-6 ps-0">
                        <h5>Ingredienti</h5>
                        <ul class="list-group">
                            <li *ngFor="let ingredient of selectedRecipe.ingredients; index as i" class="list-group-item d-flex justify-content-between align-items-center">
                              <img class="ingredient-img" [src]="ingredient.s3filename" alt="">  
                              <span>{{ingredient.name}}</span>
                              <span class="badge text-bg-primary rounded-pill">{{selectedRecipe.recipeIngredients[i].weight}} gr.</span>
                            </li>
                        </ul>
                    </div>
                    <div class="col-6">
                        <div class="d-flex justify-content-center w-100">
                            <div class="position-relative overlay-wrapper bgi-no-repeat bgi-position-center bgi-size-cover card-rounded h-300px
                            d-flex justify-content-center align-content-center overflow-hidden" style="width: 300px;" [style.background-image]="'url('+selectedRecipe.s3filename+')'">                            
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt-5">
                    <div class="col-12 ps-0">
                        <h5>Descrizione ricetta</h5>
                        <p>{{selectedRecipe.description}}</p>
                    </div>
                </div>
                <div class="row px-0 mt-3">
                    <h3 class="ps-0">Dati nutrizionali della ricetta</h3>
                    <div class="my-3 d-flex justify-content-between gap-2 px-0">
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Calorie</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{ getTotalKcal() | number: "1.0-3"}} Kcal</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Proteine</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{ getTotalValue('proteins') | number: "1.0-3"}} gr</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Carboidrati</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{ getTotalValue('carbohydrates') | number: "1.0-3"}} gr</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Grassi</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{ getTotalValue('fats') | number: "1.0-3"}} gr</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Zuccheri</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{ getTotalValue('sugars') | number: "1.0-3"}} gr</h3>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row px-0 mt-3">
                    <h3 class="ps-0">Footprint della ricetta</h3>
                    <div class="my-3 d-flex justify-content-between gap-2 px-0">
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Consumo di acqua</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{totalWF / 100 | number: "1.0-3"}} litri</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Consumo di suolo</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{totalEF / 10 | number: "1.0-3"}} mq</h3>
                            </div>
                        </div>
                        <div class="card text-bg-light mb-3" style="width: calc(100% / 3); height: 150px;">
                            <div class="card-header">Emissioni di CO2</div>
                            <div class="card-body d-flex justify-content-center align-items-center">
                                <h3 class="card-title">{{totalCF / 10 | number: "1.0-3"}} kg</h3>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>